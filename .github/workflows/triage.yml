name: Issue Triage

on:
  issues:
    types: [opened, edited]

jobs:
  triage:
    runs-on: ubuntu-latest
    permissions:
      issues: write
    steps:
      - name: Auto-Assign Admin
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'add-assignees'
          token: ${{ secrets.GITHUB_TOKEN }}
          assignees: 'PoojasPatel013'

      - name: Auto-Label based on Title/Body
        uses: actions/github-script@v7
        with:
          script: |
            const title = context.payload.issue.title.toLowerCase();
            const body = context.payload.issue.body ? context.payload.issue.body.toLowerCase() : "";
            const labels = [];
            
            if (title.includes('bug') || body.includes('bug') || title.includes('error') || title.includes('fail')) {
              labels.push('bug');
            }
            if (title.includes('feature') || body.includes('feature') || title.includes('request')) {
              labels.push('enhancement');
            }
            if (title.includes('doc') || body.includes('documentation')) {
              labels.push('documentation');
            }
            
            if (labels.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.issue.number,
                labels: labels
              });
            }

      - name: Auto-Reply to User and Request Review
        uses: actions-cool/issues-helper@v3
        with:
          actions: 'create-comment'
          token: ${{ secrets.GITHUB_TOKEN }}
          body: |
            Hi @${{ github.actor }}, thanks for opening this issue! ðŸ¤–
            
            I have automatically assigned this to our admin @PoojasPatel013 for review.
            
            **Status:**
            - [x] Admin Assigned
            - [ ] Labels Applied (Check sidebar)
            - [ ] Under Review
            
            Please wait for further updates.
